\hypertarget{arm_8c}{}\section{arm.\+c File Reference}
\label{arm_8c}\index{arm.\+c@{arm.\+c}}


arm library  


{\ttfamily \#include \char`\"{}include/arm.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}include/definitions.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}math.\+h\char`\"{}}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{arm_8c_aec43762dc86e029b395d4e5819192c2d}{I\+SR} (T\+I\+M\+E\+R0\+\_\+\+C\+O\+M\+P\+A\+\_\+vect)
\begin{DoxyCompactList}\small\item\em Timer I\+SR that runs at 100\+Hz. \end{DoxyCompactList}\item 
void \hyperlink{arm_8c_aafced3304763025ad0de267efe8e6852}{init\+Arm} ()\hypertarget{arm_8c_aafced3304763025ad0de267efe8e6852}{}\label{arm_8c_aafced3304763025ad0de267efe8e6852}

\begin{DoxyCompactList}\small\item\em initialize the arm variables \end{DoxyCompactList}\item 
void \hyperlink{arm_8c_a9745f35ca229658cc342286ea75c0b77}{setup\+Timer} ()\hypertarget{arm_8c_a9745f35ca229658cc342286ea75c0b77}{}\label{arm_8c_a9745f35ca229658cc342286ea75c0b77}

\begin{DoxyCompactList}\small\item\em sets a 100\+Hz timer up on Timer 0 \end{DoxyCompactList}\item 
void \hyperlink{arm_8c_af2524895ed2fd62a1deddec06a271c73}{service\+Arm} ()\hypertarget{arm_8c_af2524895ed2fd62a1deddec06a271c73}{}\label{arm_8c_af2524895ed2fd62a1deddec06a271c73}

\begin{DoxyCompactList}\small\item\em runs functions critical to arm operation. Call as often as possible. \end{DoxyCompactList}\item 
float \hyperlink{arm_8c_ad6888ae9e61522b34a617403a8e4519b}{get\+Joint\+Angle} (int joint)
\begin{DoxyCompactList}\small\item\em gets the current, calibrated joint angle of the passed joint number \end{DoxyCompactList}\item 
int \hyperlink{arm_8c_a70b9182627cf76216575f38320be752f}{get\+Current} (int joint)
\begin{DoxyCompactList}\small\item\em gets motor current of specified joint \end{DoxyCompactList}\item 
float \hyperlink{arm_8c_aff4f4ed0f1b0d910cb5212bbbb6cb945}{get\+Average\+Current} (int command, int current)
\begin{DoxyCompactList}\small\item\em Function for managing the currents gathered and averaging them when asked. \end{DoxyCompactList}\item 
void \hyperlink{arm_8c_ae3ec65c5c46c10e2f3a1415558a3b01e}{set\+Joint\+Angles} (int lower\+Joint, int upper\+Joint)
\begin{DoxyCompactList}\small\item\em updates globals with new desired ones \end{DoxyCompactList}\item 
float \hyperlink{arm_8c_ab2cee43f1fce1131e584096fc342b0d9}{get\+Time\+Seconds} ()
\begin{DoxyCompactList}\small\item\em gets the time in seconds \end{DoxyCompactList}\item 
void \hyperlink{arm_8c_a2802c150f10b92c1b7a57da6720510db}{calc\+XY} ()\hypertarget{arm_8c_a2802c150f10b92c1b7a57da6720510db}{}\label{arm_8c_a2802c150f10b92c1b7a57da6720510db}

\begin{DoxyCompactList}\small\item\em calculates forward kinematics for arm and updates global position \end{DoxyCompactList}\item 
B\+O\+OL \hyperlink{arm_8c_a39c5ec2326206bfdd7d3c68693cf8143}{in\+Position} (int theta1, int theta2)
\begin{DoxyCompactList}\small\item\em check if the arm is in the angle position specified \end{DoxyCompactList}\item 
B\+O\+OL \hyperlink{arm_8c_ab347f20ca0db3f1946386b19805bab10}{done\+Moving} ()
\begin{DoxyCompactList}\small\item\em checks if the arm is in desired position \end{DoxyCompactList}\item 
void \hyperlink{arm_8c_ab01fb4092c206e17432172dc4b973dd2}{set\+Position} (float x, float y)
\begin{DoxyCompactList}\small\item\em calculates IK values and sets angles \end{DoxyCompactList}\item 
int \hyperlink{arm_8c_a32998a695799dfc3a7c4b31b4da7de9d}{calibrated\+I\+R\+Val} (int \hyperlink{_periph_8c_ae0fb6b592e76f0934db14682e63982df}{I\+R\+Dist})
\begin{DoxyCompactList}\small\item\em uses a polynomial to calibrate the IR distance readings \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
float \hyperlink{arm_8c_a43c5fa5a02f5e9f3faf0468011ca2ec2}{degrees\+Per\+Joint1\+Val}
\item 
float \hyperlink{arm_8c_ab1df5f43b22723b086d287834af86099}{degrees\+Per\+Joint2\+Val}
\item 
float \hyperlink{arm_8c_ac9567e94c04c0a6b45f86ad912eb211c}{x\+\_\+coord}
\item 
float \hyperlink{arm_8c_adec4b270699e4ef43679cf77763c719a}{y\+\_\+coord}
\item 
float \hyperlink{arm_8c_a29c7979fe9a7b4caa38b09f6fd00df36}{L2\+L2}
\item 
float \hyperlink{arm_8c_a87f182902295d8bfa7b986823375075a}{L3\+L3}
\item 
int \hyperlink{arm_8c_aea49cfec201b381550034ecd0110a85f}{lower\+Angle}
\item 
int \hyperlink{arm_8c_a6768686fa1db632b8d252e73b43633d5}{upper\+Angle}
\item 
volatile B\+O\+OL \hyperlink{arm_8c_a923be170e1f5d0b2ddf9fc64d04cdfe2}{service\+P\+ID}
\item 
volatile unsigned long \hyperlink{arm_8c_a85fd9b6a089055602b3c72e135b6a809}{timer\+Count}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
arm library 

\begin{DoxyAuthor}{Author}
\href{mailto:cpbove@wpi.edu}{\tt cpbove@wpi.\+edu} 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
30-\/\+Jan-\/2016 
\end{DoxyDate}
\begin{DoxyVersion}{Version}
1.\+0 
\end{DoxyVersion}


\subsection{Function Documentation}
\index{arm.\+c@{arm.\+c}!calibrated\+I\+R\+Val@{calibrated\+I\+R\+Val}}
\index{calibrated\+I\+R\+Val@{calibrated\+I\+R\+Val}!arm.\+c@{arm.\+c}}
\subsubsection[{\texorpdfstring{calibrated\+I\+R\+Val(int I\+R\+Dist)}{calibratedIRVal(int IRDist)}}]{\setlength{\rightskip}{0pt plus 5cm}int calibrated\+I\+R\+Val (
\begin{DoxyParamCaption}
\item[{int}]{I\+R\+Dist}
\end{DoxyParamCaption}
)}\hypertarget{arm_8c_a32998a695799dfc3a7c4b31b4da7de9d}{}\label{arm_8c_a32998a695799dfc3a7c4b31b4da7de9d}


uses a polynomial to calibrate the IR distance readings 


\begin{DoxyParams}{Parameters}
{\em I\+R\+Dist} & distance reading in mm\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
calibrated IR distance in mm 
\end{DoxyReturn}
\index{arm.\+c@{arm.\+c}!done\+Moving@{done\+Moving}}
\index{done\+Moving@{done\+Moving}!arm.\+c@{arm.\+c}}
\subsubsection[{\texorpdfstring{done\+Moving()}{doneMoving()}}]{\setlength{\rightskip}{0pt plus 5cm}B\+O\+OL done\+Moving (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{arm_8c_ab347f20ca0db3f1946386b19805bab10}{}\label{arm_8c_ab347f20ca0db3f1946386b19805bab10}


checks if the arm is in desired position 

\begin{DoxyReturn}{Returns}
true if in desired position 
\end{DoxyReturn}
\index{arm.\+c@{arm.\+c}!get\+Average\+Current@{get\+Average\+Current}}
\index{get\+Average\+Current@{get\+Average\+Current}!arm.\+c@{arm.\+c}}
\subsubsection[{\texorpdfstring{get\+Average\+Current(int command, int current)}{getAverageCurrent(int command, int current)}}]{\setlength{\rightskip}{0pt plus 5cm}float get\+Average\+Current (
\begin{DoxyParamCaption}
\item[{int}]{command, }
\item[{int}]{current}
\end{DoxyParamCaption}
)}\hypertarget{arm_8c_aff4f4ed0f1b0d910cb5212bbbb6cb945}{}\label{arm_8c_aff4f4ed0f1b0d910cb5212bbbb6cb945}


Function for managing the currents gathered and averaging them when asked. 


\begin{DoxyParams}{Parameters}
{\em current} & Current to be added to the stored values \\
\hline
{\em command} & Command of what to be done with the function, either reset\+Current,add\+Current,retrieve\+Average\+Current\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
current in mA 
\end{DoxyReturn}
\index{arm.\+c@{arm.\+c}!get\+Current@{get\+Current}}
\index{get\+Current@{get\+Current}!arm.\+c@{arm.\+c}}
\subsubsection[{\texorpdfstring{get\+Current(int joint)}{getCurrent(int joint)}}]{\setlength{\rightskip}{0pt plus 5cm}int get\+Current (
\begin{DoxyParamCaption}
\item[{int}]{joint}
\end{DoxyParamCaption}
)}\hypertarget{arm_8c_a70b9182627cf76216575f38320be752f}{}\label{arm_8c_a70b9182627cf76216575f38320be752f}


gets motor current of specified joint 


\begin{DoxyParams}{Parameters}
{\em joint} & The joint to get the current for\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
current in mA 
\end{DoxyReturn}
\index{arm.\+c@{arm.\+c}!get\+Joint\+Angle@{get\+Joint\+Angle}}
\index{get\+Joint\+Angle@{get\+Joint\+Angle}!arm.\+c@{arm.\+c}}
\subsubsection[{\texorpdfstring{get\+Joint\+Angle(int joint)}{getJointAngle(int joint)}}]{\setlength{\rightskip}{0pt plus 5cm}float get\+Joint\+Angle (
\begin{DoxyParamCaption}
\item[{int}]{joint}
\end{DoxyParamCaption}
)}\hypertarget{arm_8c_ad6888ae9e61522b34a617403a8e4519b}{}\label{arm_8c_ad6888ae9e61522b34a617403a8e4519b}


gets the current, calibrated joint angle of the passed joint number 


\begin{DoxyParams}{Parameters}
{\em joint} & 1 or 2 of the joint to get the angle for\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
angle of joint in degrees (generally 0 to 180) 
\end{DoxyReturn}
\index{arm.\+c@{arm.\+c}!get\+Time\+Seconds@{get\+Time\+Seconds}}
\index{get\+Time\+Seconds@{get\+Time\+Seconds}!arm.\+c@{arm.\+c}}
\subsubsection[{\texorpdfstring{get\+Time\+Seconds()}{getTimeSeconds()}}]{\setlength{\rightskip}{0pt plus 5cm}float get\+Time\+Seconds (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{arm_8c_ab2cee43f1fce1131e584096fc342b0d9}{}\label{arm_8c_ab2cee43f1fce1131e584096fc342b0d9}


gets the time in seconds 

\begin{DoxyReturn}{Returns}
time in seconds 
\end{DoxyReturn}
\index{arm.\+c@{arm.\+c}!in\+Position@{in\+Position}}
\index{in\+Position@{in\+Position}!arm.\+c@{arm.\+c}}
\subsubsection[{\texorpdfstring{in\+Position(int theta1, int theta2)}{inPosition(int theta1, int theta2)}}]{\setlength{\rightskip}{0pt plus 5cm}B\+O\+OL in\+Position (
\begin{DoxyParamCaption}
\item[{int}]{theta1, }
\item[{int}]{theta2}
\end{DoxyParamCaption}
)}\hypertarget{arm_8c_a39c5ec2326206bfdd7d3c68693cf8143}{}\label{arm_8c_a39c5ec2326206bfdd7d3c68693cf8143}


check if the arm is in the angle position specified 


\begin{DoxyParams}{Parameters}
{\em theta1} & angle of first joint \\
\hline
{\em theta2} & angle of second joint\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
T\+R\+UE if arm is between 
\end{DoxyReturn}
\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000005}{Todo}]pass in the threshold to use \end{DoxyRefDesc}
\index{arm.\+c@{arm.\+c}!I\+SR@{I\+SR}}
\index{I\+SR@{I\+SR}!arm.\+c@{arm.\+c}}
\subsubsection[{\texorpdfstring{I\+S\+R(\+T\+I\+M\+E\+R0\+\_\+\+C\+O\+M\+P\+A\+\_\+vect)}{ISR(TIMER0_COMPA_vect)}}]{\setlength{\rightskip}{0pt plus 5cm}I\+SR (
\begin{DoxyParamCaption}
\item[{T\+I\+M\+E\+R0\+\_\+\+C\+O\+M\+P\+A\+\_\+vect}]{}
\end{DoxyParamCaption}
)}\hypertarget{arm_8c_aec43762dc86e029b395d4e5819192c2d}{}\label{arm_8c_aec43762dc86e029b395d4e5819192c2d}


Timer I\+SR that runs at 100\+Hz. 

set flags for servicing at fixed intervals.


\begin{DoxyParams}{Parameters}
{\em T\+I\+M\+E\+R0\+\_\+\+C\+O\+M\+P\+A\+\_\+vect} & Interrupt vector for timer0 vector on A\+VR \\
\hline
\end{DoxyParams}
\index{arm.\+c@{arm.\+c}!set\+Joint\+Angles@{set\+Joint\+Angles}}
\index{set\+Joint\+Angles@{set\+Joint\+Angles}!arm.\+c@{arm.\+c}}
\subsubsection[{\texorpdfstring{set\+Joint\+Angles(int lower\+Joint, int upper\+Joint)}{setJointAngles(int lowerJoint, int upperJoint)}}]{\setlength{\rightskip}{0pt plus 5cm}void set\+Joint\+Angles (
\begin{DoxyParamCaption}
\item[{int}]{lower\+Joint, }
\item[{int}]{upper\+Joint}
\end{DoxyParamCaption}
)}\hypertarget{arm_8c_ae3ec65c5c46c10e2f3a1415558a3b01e}{}\label{arm_8c_ae3ec65c5c46c10e2f3a1415558a3b01e}


updates globals with new desired ones 


\begin{DoxyParams}{Parameters}
{\em lower\+Joint} & position for the lower joint 1 \\
\hline
{\em upper\+Joint} & position for the upper joint 2 \\
\hline
\end{DoxyParams}
\index{arm.\+c@{arm.\+c}!set\+Position@{set\+Position}}
\index{set\+Position@{set\+Position}!arm.\+c@{arm.\+c}}
\subsubsection[{\texorpdfstring{set\+Position(float x, float y)}{setPosition(float x, float y)}}]{\setlength{\rightskip}{0pt plus 5cm}void set\+Position (
\begin{DoxyParamCaption}
\item[{float}]{x, }
\item[{float}]{y}
\end{DoxyParamCaption}
)}\hypertarget{arm_8c_ab01fb4092c206e17432172dc4b973dd2}{}\label{arm_8c_ab01fb4092c206e17432172dc4b973dd2}


calculates IK values and sets angles 


\begin{DoxyParams}{Parameters}
{\em x} & desired x position \\
\hline
{\em y} & desired y position \\
\hline
\end{DoxyParams}


\subsection{Variable Documentation}
\index{arm.\+c@{arm.\+c}!degrees\+Per\+Joint1\+Val@{degrees\+Per\+Joint1\+Val}}
\index{degrees\+Per\+Joint1\+Val@{degrees\+Per\+Joint1\+Val}!arm.\+c@{arm.\+c}}
\subsubsection[{\texorpdfstring{degrees\+Per\+Joint1\+Val}{degreesPerJoint1Val}}]{\setlength{\rightskip}{0pt plus 5cm}degrees\+Per\+Joint1\+Val}\hypertarget{arm_8c_a43c5fa5a02f5e9f3faf0468011ca2ec2}{}\label{arm_8c_a43c5fa5a02f5e9f3faf0468011ca2ec2}
for storing the degrees per adc value for joint 1 \index{arm.\+c@{arm.\+c}!degrees\+Per\+Joint2\+Val@{degrees\+Per\+Joint2\+Val}}
\index{degrees\+Per\+Joint2\+Val@{degrees\+Per\+Joint2\+Val}!arm.\+c@{arm.\+c}}
\subsubsection[{\texorpdfstring{degrees\+Per\+Joint2\+Val}{degreesPerJoint2Val}}]{\setlength{\rightskip}{0pt plus 5cm}degrees\+Per\+Joint2\+Val}\hypertarget{arm_8c_ab1df5f43b22723b086d287834af86099}{}\label{arm_8c_ab1df5f43b22723b086d287834af86099}
for storing the degrees per adc value for joint 2

\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000002}{Todo}]change these to constants \end{DoxyRefDesc}
\index{arm.\+c@{arm.\+c}!L2\+L2@{L2\+L2}}
\index{L2\+L2@{L2\+L2}!arm.\+c@{arm.\+c}}
\subsubsection[{\texorpdfstring{L2\+L2}{L2L2}}]{\setlength{\rightskip}{0pt plus 5cm}L2\+L2}\hypertarget{arm_8c_a29c7979fe9a7b4caa38b09f6fd00df36}{}\label{arm_8c_a29c7979fe9a7b4caa38b09f6fd00df36}
constant for optimizing Link 2 Length $^\wedge$2 \index{arm.\+c@{arm.\+c}!L3\+L3@{L3\+L3}}
\index{L3\+L3@{L3\+L3}!arm.\+c@{arm.\+c}}
\subsubsection[{\texorpdfstring{L3\+L3}{L3L3}}]{\setlength{\rightskip}{0pt plus 5cm}L3\+L3}\hypertarget{arm_8c_a87f182902295d8bfa7b986823375075a}{}\label{arm_8c_a87f182902295d8bfa7b986823375075a}
constant for optimizing Link 3 Length $^\wedge$2 \index{arm.\+c@{arm.\+c}!lower\+Angle@{lower\+Angle}}
\index{lower\+Angle@{lower\+Angle}!arm.\+c@{arm.\+c}}
\subsubsection[{\texorpdfstring{lower\+Angle}{lowerAngle}}]{\setlength{\rightskip}{0pt plus 5cm}lower\+Angle}\hypertarget{arm_8c_aea49cfec201b381550034ecd0110a85f}{}\label{arm_8c_aea49cfec201b381550034ecd0110a85f}
for storing the current lower\+Angle of the arm \index{arm.\+c@{arm.\+c}!service\+P\+ID@{service\+P\+ID}}
\index{service\+P\+ID@{service\+P\+ID}!arm.\+c@{arm.\+c}}
\subsubsection[{\texorpdfstring{service\+P\+ID}{servicePID}}]{\setlength{\rightskip}{0pt plus 5cm}service\+P\+ID}\hypertarget{arm_8c_a923be170e1f5d0b2ddf9fc64d04cdfe2}{}\label{arm_8c_a923be170e1f5d0b2ddf9fc64d04cdfe2}
flag -\/ T\+R\+UE if P\+ID controller needs to be serviced, F\+A\+L\+SE otherwise \index{arm.\+c@{arm.\+c}!timer\+Count@{timer\+Count}}
\index{timer\+Count@{timer\+Count}!arm.\+c@{arm.\+c}}
\subsubsection[{\texorpdfstring{timer\+Count}{timerCount}}]{\setlength{\rightskip}{0pt plus 5cm}timer\+Count}\hypertarget{arm_8c_a85fd9b6a089055602b3c72e135b6a809}{}\label{arm_8c_a85fd9b6a089055602b3c72e135b6a809}
for keeping time. increments in 0.\+01 seconds \index{arm.\+c@{arm.\+c}!upper\+Angle@{upper\+Angle}}
\index{upper\+Angle@{upper\+Angle}!arm.\+c@{arm.\+c}}
\subsubsection[{\texorpdfstring{upper\+Angle}{upperAngle}}]{\setlength{\rightskip}{0pt plus 5cm}upper\+Angle}\hypertarget{arm_8c_a6768686fa1db632b8d252e73b43633d5}{}\label{arm_8c_a6768686fa1db632b8d252e73b43633d5}
for storing the current upper\+Angle of the arm

\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000004}{Todo}]get rid of these globals \end{DoxyRefDesc}
\index{arm.\+c@{arm.\+c}!x\+\_\+coord@{x\+\_\+coord}}
\index{x\+\_\+coord@{x\+\_\+coord}!arm.\+c@{arm.\+c}}
\subsubsection[{\texorpdfstring{x\+\_\+coord}{x_coord}}]{\setlength{\rightskip}{0pt plus 5cm}x\+\_\+coord}\hypertarget{arm_8c_ac9567e94c04c0a6b45f86ad912eb211c}{}\label{arm_8c_ac9567e94c04c0a6b45f86ad912eb211c}
for storing the current x coordinate of the arm \index{arm.\+c@{arm.\+c}!y\+\_\+coord@{y\+\_\+coord}}
\index{y\+\_\+coord@{y\+\_\+coord}!arm.\+c@{arm.\+c}}
\subsubsection[{\texorpdfstring{y\+\_\+coord}{y_coord}}]{\setlength{\rightskip}{0pt plus 5cm}y\+\_\+coord}\hypertarget{arm_8c_adec4b270699e4ef43679cf77763c719a}{}\label{arm_8c_adec4b270699e4ef43679cf77763c719a}
for storing the current y coordinate of the arm

\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000003}{Todo}]get rid of these globals \end{DoxyRefDesc}
